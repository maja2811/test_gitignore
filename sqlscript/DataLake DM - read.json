{
	"name": "DataLake DM - read",
	"properties": {
		"folder": {
			"name": "ivu/DataLake"
		},
		"content": {
			"query": "\tSELECT\n\t\tItinerary.[validity_validityDate] AS koeredoegn,\n\t\tItinerary.[trainGroup_externalNumber] AS tog_nr,\n\t\tItinerary.[beginLocation_externalNumber] AS vogntur_start_station_UIC,\n\t\tItinerary.[beginLocation_abbreviation] AS vogntur_start_station_fork,\n\t\tItinerary.[endLocation_externalNumber] AS vogntur_end_station_UIC,\n\t\tItinerary.[endLocation_abbreviation] AS vogntur_end_station_fork,\n\t\t--Itinerary.[trainGroup_startDate],\n\t\tItinerary.[trainSection_beginTime] AS vogntur_start_tid,\n\t\t--Itinerary.[trainSection_beginDayOffset],\n\t\t--Itinerary.[BeginTimestamp] AS tog_start_timestamp,\n\t\tItinerary.[trainSection_endTime] AS vogntur_end_tid,\n\t\t--Itinerary.[trainSection_endDayOffset],\n\t\t--Itinerary.[EndTimestamp] AS tog_end_timestamp,\n\t\tItinerary.[trainSection_distance] AS vogntur_distance,\n\t\tItinerary.[location_externalNumber] AS station_aktuel_UIC,\n\t\tItinerary.[location_abbreviation] AS station_aktuel_fork,\n\t\tItinerary.[Station_sequence] AS station_sekvens,\n\t\tROW_NUMBER() OVER (PARTITION BY Itinerary.validity_validityDate, Itinerary.trainGroup_externalNumber  ORDER BY Itinerary.BeginTimestamp ) AS tog_sekvens,\n\t\tItinerary.[itineraryStop_operationalArrivalTime] AS ank_tid,\n\t\t--Itinerary.[itineraryStop_operationalArrivalDayOffset],\n\t\t--Itinerary.[ArrivalTimestamp],\n\t\tItinerary.[itineraryStop_operationalDepartureTime] AS afg_tid,\n\t\t--Itinerary.[itineraryStop_operationalDepartureDayOffset],\n\t\t--Itinerary.[DepartureTimestamp],\n\t\tItinerary.[Station_from] AS station_forrige,\n\t\t--Itinerary.[Station_from_externalNumber],\n\t\tItinerary.[Station_to] AS station_naeste,\n\t\t--Itinerary.[Station_to_externalNumber],\n\t\tItinerary.[itineraryStop_distance] AS statmlm_next_distance,\n\t\tCASE Itinerary.[itineraryStop_passthrough] WHEN 0 THEN 'STOP' ELSE 'GENNEMKOER' END AS stop_type,\n\t\tItinerary.[itineraryStop_track] AS spor,\n\t\t--Itinerary.[itineraryStop_networkTrainNumber],\n\t\tItinerary.[itineraryStop_trainCategory] AS tog_kategori,\n\t\tItinerary.[Koereplan72timer],\n\t\t--Itinerary.[SysValidFrom],\n\t\t--Itinerary.[SysValidTo]\n\t\tVehicleTrip.[formationElement_carSortingNumber] AS saet_nr,\n\t\tVehicleTrip.[vehicle_type] AS litra_type,\n\t\tVehicleTrip.[vehicle_vehicleNumber] AS litra_nr,\n\t\tVehicleTrip.[trip_tripType] AS trip_type,\n\t\tVehicleTrip.[predecessor_trainKey] AS pre_tog_nr,\n\t\tVehicleTrip.[predecessor_validityDate] AS pre_koeredoegn,\n\t\tVehicleTrip.[predecessor_arrivalTime] AS pre_ank_tid,\n\t\tVehicleTrip.[predecessor_arrivalTimestamp] AS pre_ank_timestamp,\n\t\tVehicleTrip.[successor_trainKey] AS post_tog_nr,\n\t\tVehicleTrip.[successor_validityDate] AS post_koeredoegn,\n\t\tVehicleTrip.[successor_departureTime] AS post_afg_tid,\n\t\tVehicleTrip.[successor_departureTimetamp] AS post_afg_timestamp\n\t\n\tFROM\n    \tOPENROWSET(\n\t        BULK 'https://datalakegen2atlasdev.dfs.core.windows.net/zone-connected/IVU/FR_Itinerary.csv',\n    \t    FORMAT = 'CSV',\n        \tHEADER_ROW = TRUE,\n        \tFIELDTERMINATOR = ';',\n\t        PARSER_VERSION = '2.0'\n    \t) \n\tWITH (\n\t\t[validity_validityDate] date,\n\t\t[trainGroup_externalNumber] bigint,\n\t\t[beginLocation_externalNumber] bigint,\n\t\t[beginLocation_abbreviation] nvarchar(4000) COLLATE Latin1_General_100_BIN2_UTF8,\n\t\t[endLocation_externalNumber] bigint,\n\t\t[endLocation_abbreviation] nvarchar(4000) COLLATE Latin1_General_100_BIN2_UTF8,\n\t\t[trainGroup_startDate] date,\n\t\t[trainSection_beginTime] time(0),\n\t\t[trainSection_beginDayOffset] bigint,\n\t\t[BeginTimestamp] datetime2(0),\n\t\t[trainSection_endTime] time(0),\n\t\t[trainSection_endDayOffset] bigint,\n\t\t[EndTimestamp] datetime2(0),\n\t\t[trainSection_distance] bigint,\n\t\t[location_externalNumber] bigint,\n\t\t[location_abbreviation] nvarchar(4000) COLLATE Latin1_General_100_BIN2_UTF8,\n\t\t[Station_sequence] bigint,\n\t\t[itineraryStop_operationalArrivalTime] time(0),\n\t\t--[itineraryStop_operationalArrivalDayOffset] bigint,\n\t\t--[ArrivalTimestamp] datetime2(0),\n\t\t[itineraryStop_operationalDepartureTime] time(0),\n\t\t--[itineraryStop_operationalDepartureDayOffset] bigint,\n\t\t--[DepartureTimestamp] datetime2(0),\n\t\t[Station_from] nvarchar(4000) COLLATE Latin1_General_100_BIN2_UTF8,\n\t\t[Station_from_externalNumber] bigint ,\n\t\t[Station_to] nvarchar(4000) COLLATE Latin1_General_100_BIN2_UTF8,\n\t\t[Station_to_externalNumber] bigint,\n\t\t[itineraryStop_distance] bigint,\n\t\t[itineraryStop_passthrough] bigint,\n\t\t[itineraryStop_track] nvarchar(4000),\n\t\t[itineraryStop_networkTrainNumber] bigint,\n\t\t[itineraryStop_trainCategory] nvarchar(4000),\n\t\t[Koereplan72timer] bigint,\n\t\t[SysValidFrom] datetime2(0),\n\t\t[SysValidTo] datetime2(0)\n\t)  AS Itinerary\n\t\nLEFT JOIN\n   \tOPENROWSET(\n       \tBULK 'https://datalakegen2atlasdev.dfs.core.windows.net/zone-connected/IVU/FR_VehicleTrip.csv',\n       \tFORMAT = 'CSV',\n       \tHEADER_ROW = TRUE,\n       \tFIELDTERMINATOR = ';',\n       \tPARSER_VERSION = '2.0'\n   \t)\nWITH (\n\t[validity_validityDate] date,\n\t[trainGroup_externalNumber] bigint,\n\t[beginLocation_externalNumber] bigint,\n\t[beginLocation_abbreviation] nvarchar(4000) COLLATE Latin1_General_100_BIN2_UTF8,\n\t[endLocation_externalNumber] bigint,\n\t[endLocation_abbreviation] nvarchar(4000) COLLATE Latin1_General_100_BIN2_UTF8,\n\t[trainGroup_startDate] date,\n\t[trainSection_beginTime] time(0),\n\t[trainSection_beginDayOffset] bigint,\n\t[BeginTimestamp] datetime2(0),\n\t[trainSection_endTime] time(0),\n\t[trainSection_endDayOffset] bigint,\n\t[EndTimestamp] datetime2(0),\n\t[trainSection_distance] bigint,\n\t[formationElement_elementIndexInFormation] bigint,\n\t[formationElement_vehicleWorkingIndexInFormation] bigint,\n\t[formationElement_carSortingNumber] bigint,\n\t[vehicle_type] nvarchar(4000),\n\t[vehicleType_abbreviation] nvarchar(4000),\n\t[vehicle_vehicleNumber] bigint,\n\t[vehicle_externalVehicleNumber] bigint,\n\t[vehicleWorking_type] nvarchar(4000),\n\t[vehicleWorking_description] nvarchar(4000),\n\t[trip_externalTripNumber] bigint,\n\t[trip_tripType] nvarchar(4000),\n\t[trip_route] nvarchar(4000),\n\t[trip_tripClass] nvarchar(4000),\n\t[predecessor_trainKey] bigint,\n\t[predecessor_validityDate] date,\n\t[predecessor_dayOffset] bigint,\n\t[predecessor_arrivalTime] time(0),\n\t[predecessor_arrivalTimestamp] datetime2(0),\n\t[predecessor_preDescription] nvarchar(4000),\n\t[successor_trainKey] bigint,\n\t[successor_validityDate] date,\n\t[successor_dayOffset] bigint,\n\t[successor_departureTime] time(0),\n\t[successor_departureTimetamp] datetime2(0),\n\t[successor_postDescription] nvarchar(4000),\n\t[Koereplan72timer] bigint,\n\t[SysValidFrom] datetime2(0),\n\t[SysValidTo] datetime2(0)\n) AS VehicleTrip\n\tON  Itinerary.validity_validityDate = VehicleTrip.validity_validityDate\n\tAND Itinerary.trainGroup_externalNumber = VehicleTrip.trainGroup_externalNumber\n\tAND Itinerary.beginLocation_externalNumber = VehicleTrip.beginLocation_externalNumber\n\tAND Itinerary.endLocation_externalNumber = VehicleTrip.endLocation_externalNumber\n\n\nORDER BY Itinerary.validity_validityDate, Itinerary.trainGroup_externalNumber, Itinerary.[trainSection_beginTime], station_sekvens, vehicle_vehicleNumber, formationElement_carSortingNumber\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "atlas-srvless-sql-dev",
				"poolName": "Built-in"
			},
			"resultLimit": -1
		},
		"type": "SqlQuery"
	}
}